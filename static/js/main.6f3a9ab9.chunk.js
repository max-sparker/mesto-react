(this["webpackJsonp4_mesto-react"]=this["webpackJsonp4_mesto-react"]||[]).push([[0],{15:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(1),c=n.n(r),o=n(6),s=n.n(o),i=(n(15),n(9)),l=n(2);var u=function(){return Object(a.jsx)("header",{className:"header",children:Object(a.jsx)("div",{className:"header__logo"})})},p=c.a.createContext();var d=function(e){var t=e.card,n=e.onCardClick,r=e.onCardLike,o=e.onCardDelete,s=c.a.useContext(p),i=t.owner._id===s._id,l="card__remove-btn ".concat(i?"card__remove-btn_visible":null),u=t.likes.some((function(e){return e._id===s._id})),d="card__like-btn ".concat(u?"card__like-btn_liked":null);return Object(a.jsxs)("article",{className:"card",children:[Object(a.jsx)("img",{className:"card__image",src:t.link,alt:t.name,onClick:function(){n(t)}}),Object(a.jsx)("button",{className:l,type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onClick:function(){o(t)}}),Object(a.jsxs)("div",{className:"card__title",children:[Object(a.jsx)("h2",{className:"card__name",children:t.name}),Object(a.jsxs)("div",{className:"card__like-container",children:[Object(a.jsx)("button",{className:d,type:"button","aria-label":"\u041c\u043d\u0435 \u043d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",onClick:function(){r(t)}}),Object(a.jsx)("p",{className:"card__like-counter",children:t.likes.length})]})]})]})};var _=function(e){var t=e.onEditProfile,n=e.onAddPlace,r=e.onEditAvatar,o=e.onCardClick,s=e.cards,i=e.onCardLike,l=e.onCardDelete,u=c.a.useContext(p);return Object(a.jsxs)("main",{className:"content",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"profile__avatar-container",children:[Object(a.jsx)("img",{className:"profile__avatar",src:u.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f ".concat(u.name)}),Object(a.jsx)("button",{className:"profile__avatar-edit-btn",type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",onClick:r})]}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsxs)("div",{className:"profile__title",children:[Object(a.jsx)("h1",{className:"profile__name",children:u.name}),Object(a.jsx)("button",{className:"profile__edit-btn",type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onClick:t})]}),Object(a.jsx)("p",{className:"profile__description",children:u.about})]}),Object(a.jsx)("button",{className:"profile__add-btn",type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",onClick:n})]}),Object(a.jsx)("section",{className:"places",children:s.map((function(e){return Object(a.jsx)(d,{card:e,onCardClick:o,onCardLike:i,onCardDelete:l},e._id)}))})]})},j=new Date;var b=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsxs)("p",{className:"footer__copyright",children:["\xa9 ",j.getFullYear()," Mesto Russia"]})})};var h=function(e){var t=e.card,n=e.isOpen,r=e.onClose,c=e.onCloseOverlay;return Object(a.jsxs)("section",{className:"popup popup_type_image ".concat(n?"popup_opened":""),children:[Object(a.jsx)("div",{className:"popup__overlay",onClick:c}),Object(a.jsxs)("div",{className:"popup__wrap",children:[Object(a.jsx)("button",{className:"popup__close-btn",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e",onClick:r}),Object(a.jsxs)("figure",{className:"popup__full",children:[Object(a.jsx)("img",{className:"popup__image",src:t.link,alt:"\u0424\u043e\u0442\u043e: ".concat(t.name)}),Object(a.jsx)("figcaption",{className:"popup__desc",children:t.name})]})]})]})},f=n(7),m=n(8),v=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(f.a)(this,e),this._url=n,this._headers=a}return Object(m.a)(e,[{key:"_onError",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443: ".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._url,"/users/me"),{headers:this._headers}).then(this._onError)}},{key:"setUserInfo",value:function(e){return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.description})}).then(this._onError)}},{key:"updateUserAvatar",value:function(e){return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._onError)}},{key:"getInitialCards",value:function(){return fetch("".concat(this._url,"/cards"),{headers:this._headers}).then(this._onError)}},{key:"createCard",value:function(e){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.placename,link:e.placelink})}).then(this._onError)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._onError)}},{key:"changeLikeCardStatus",value:function(e,t){return t?fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._onError):fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._onError)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-16",headers:{"Content-Type":"application/json",authorization:"c211647d-a4c4-4f78-99de-8c8f862db42e"}});var O=function(e){var t=e.name,n=e.title,r=e.children,c=e.isOpen,o=e.onClose,s=e.onCloseByOverlay,i=e.onSubmit,l=e.buttonText,u=e.buttonLabel,p=e.isSaving;return Object(a.jsxs)("section",{className:"popup popup_type_".concat(t," ").concat(c?"popup_opened":""),children:[Object(a.jsx)("div",{className:"popup__overlay",onClick:s}),Object(a.jsxs)("div",{className:"popup__container",children:[Object(a.jsx)("button",{className:"popup__close-btn",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e",onClick:o}),Object(a.jsx)("h3",{className:"popup__title",children:n}),Object(a.jsxs)("form",{className:"popup__form",name:t,onSubmit:i,children:[r,Object(a.jsx)("button",{className:"popup__btn",type:"submit","aria-label":u,children:p?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":l})]})]})]})};var x=function(e){var t=e.isOpen,n=e.onClose,r=e.onCloseOverlay,o=e.onUpdateUser,s=e.isSaving,i=c.a.useContext(p),u=c.a.useState(""),d=Object(l.a)(u,2),_=d[0],j=d[1],b=c.a.useState(""),h=Object(l.a)(b,2),f=h[0],m=h[1];return c.a.useEffect((function(){j(i.name),m(i.about)}),[i]),Object(a.jsxs)(O,{name:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:n,onCloseByOverlay:r,onSubmit:function(e){e.preventDefault(),o({name:_,description:f})},buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonLabel:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isSaving:s,children:[Object(a.jsx)("input",{className:"popup__input popup__input_type_username",type:"text",name:"username",placeholder:"\u0418\u043c\u044f",required:!0,minLength:"2",maxLength:"40",value:_||"",onChange:function(e){j(e.target.value)}}),Object(a.jsx)("span",{className:"popup__error",id:"username-input-error"}),Object(a.jsx)("input",{className:"popup__input popup__input_type_description",type:"text",name:"description",placeholder:"\u041e \u0421\u0435\u0431\u0435",required:!0,minLength:"2",maxLength:"200",value:f||"",onChange:function(e){m(e.target.value)}}),Object(a.jsx)("span",{className:"popup__error",id:"description-input-error"})]})};var C=function(e){var t=e.isOpen,n=e.onClose,r=e.onCloseOverlay,o=e.onUpdateAvatar,s=e.isSaving,i=c.a.useContext(p),l=c.a.useRef();return c.a.useEffect((function(){l.current.value=""}),[i]),Object(a.jsxs)(O,{name:"update-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:n,onCloseByOverlay:r,onSubmit:function(e){e.preventDefault(),o({avatar:l.current.value})},buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonLabel:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isSaving:s,children:[Object(a.jsx)("input",{className:"popup__input popup__input_type_avatarlink",type:"url",name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",required:!0,ref:l}),Object(a.jsx)("span",{className:"popup__error",id:"avatar-input-error"})]})};var y=function(e){var t=e.isOpen,n=e.onClose,r=e.onCloseOverlay,o=e.onAddPlace,s=e.isSaving,i=c.a.useRef(),l=c.a.useRef();return c.a.useEffect((function(){i.current.value="",l.current.value=""}),[t]),Object(a.jsxs)(O,{name:"add-place",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:n,onCloseByOverlay:r,onSubmit:function(e){e.preventDefault(),o({placename:i.current.value,placelink:l.current.value})},buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",buttonLabel:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0441\u0442\u043e",isSaving:s,children:[Object(a.jsx)("input",{className:"popup__input popup__input_type_placename",type:"text",name:"placename",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,maxLength:"30",ref:i}),Object(a.jsx)("span",{className:"popup__error",id:"placename-input-error"}),Object(a.jsx)("input",{className:"popup__input popup__input_type_placelink",type:"url",name:"placelink",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,ref:l}),Object(a.jsx)("span",{className:"popup__error",id:"placelink-input-error"})]})};var k=function(e){var t=e.isOpen,n=e.onClose,r=e.onCloseOverlay,c=e.onConfirmDelete,o=e.isSaving;return Object(a.jsx)(O,{name:"confirm-delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:t,onClose:n,onCloseByOverlay:r,onSubmit:function(e){e.preventDefault(),c()},buttonText:"\u0414\u0430",buttonLabel:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438",isSaving:o})};var N=function(){var e=c.a.useState(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],o=c.a.useState(!1),s=Object(l.a)(o,2),d=s[0],j=s[1],f=c.a.useState(!1),m=Object(l.a)(f,2),O=m[0],N=m[1],g=c.a.useState(!1),S=Object(l.a)(g,2),E=S[0],L=S[1],U=c.a.useState(!1),D=Object(l.a)(U,2),P=D[0],T=D[1],A=c.a.useState({}),w=Object(l.a)(A,2),I=w[0],B=w[1],q=c.a.useState([]),J=Object(l.a)(q,2),R=J[0],H=J[1],M=c.a.useState(!1),z=Object(l.a)(M,2),F=z[0],Y=z[1],G=c.a.useState({}),K=Object(l.a)(G,2),Q=K[0],V=K[1];function W(){r(!1),j(!1),N(!1),L(!1),T(!1)}function X(e){e.target===e.currentTarget&&W()}return c.a.useEffect((function(){Promise.all([v.getUserInfo(),v.getInitialCards()]).then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];B(n),H(a)})).catch((function(e){console.error(e)}))}),[]),c.a.useEffect((function(){function e(e){"Escape"===e.key&&W()}return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[]),Object(a.jsx)("div",{className:"page",children:Object(a.jsxs)(p.Provider,{value:I,children:[Object(a.jsx)(u,{}),Object(a.jsx)(_,{onEditProfile:function(){r(!0)},onAddPlace:function(){j(!0)},onEditAvatar:function(){N(!0)},onCardClick:function(e){V(e),L(!0)},cards:R,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===I._id}));v.changeLikeCardStatus(e._id,!t).then((function(t){var n=R.map((function(n){return n._id===e._id?t:n}));H(n)})).catch((function(e){console.error(e)}))},onCardDelete:function(e){T(!0),V(e)}}),Object(a.jsx)(x,{isOpen:n,onClose:W,onCloseOverlay:X,onUpdateUser:function(e){Y(!0),v.setUserInfo(e).then((function(e){B(e)})).catch((function(e){console.error(e)})).finally((function(){return Y(!1)})),W()},isSaving:F}),Object(a.jsx)(C,{isOpen:O,onClose:W,onUpdateAvatar:function(e){Y(!0),v.updateUserAvatar(e).then((function(e){B(e)})).catch((function(e){console.error(e)})).finally((function(){return Y(!1)})),W()},onCloseOverlay:X,isSaving:F}),Object(a.jsx)(y,{isOpen:d,onClose:W,onCloseOverlay:X,onAddPlace:function(e){Y(!0),v.createCard(e).then((function(e){H([e].concat(Object(i.a)(R)))})).catch((function(e){console.error(e)})).finally((function(){return Y(!1)})),W()},isSaving:F}),Object(a.jsx)(h,{card:Q,isOpen:E,onClose:W,onCloseOverlay:X}),Object(a.jsx)(k,{isOpen:P,onClose:W,onCloseOverlay:X,onConfirmDelete:function(){Y(!0),v.deleteCard(Q._id).then((function(){var e=R.filter((function(e){return e._id!==Q._id}));H(e)})).catch((function(e){console.error(e)})).finally((function(){Y(!1)})),W()}}),Object(a.jsx)(b,{})]})})};s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(N,{})}),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.6f3a9ab9.chunk.js.map